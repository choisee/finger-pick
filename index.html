<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>최후의 손가락</title>
    <style>
      body,
      html {
        width: 100%;
        height: 100%;
        margin: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: black;
      }

      #gameArea {
        width: 100%;
        height: 100%;
        position: relative;
        background-color: gray;
        padding: 5px;
      }

      .touchHighlight {
        position: absolute;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background-color: rgba(255, 0, 0, 0.5);
        pointer-events: none;
      }
    </style>
  </head>

  <body>
    <div id="gameArea"></div>
    <script>
      // Select the game area (the screen)
      const gameArea = document.getElementById("gameArea");

      // Store active touches
      let touches = [];

      // Create a function to highlight touched areas
      function highlightTouch(touch) {
        const touchElement = document.createElement("div");
        touchElement.classList.add("touchHighlight");

        // Set the position of the highlight based on the touch location
        touchElement.style.left = `${touch.clientX - 25}px`; // Centered on the touch
        touchElement.style.top = `${touch.clientY - 25}px`;

        // Append it to the game area
        gameArea.appendChild(touchElement);

        // Add this touch to the active touches array
        touches.push(touchElement);

        if (touches.length === 3) {
          let interval = setInterval(() => {
            // If there are no more touches left, stop the interval
            if (touches.length === 0) {
              clearInterval(interval);
              alert("Winner! All highlights removed.");
              return;
            }

            // Randomly pick an index from the active touches
            const randomIndex = Math.floor(Math.random() * touches.length);
            const touchToRemove = touches[randomIndex];

            // Fade out the random touch highlight
            touchToRemove.style.opacity = "0";

            // Remove it from the touches array and DOM after fading
            setTimeout(() => {
              gameArea.removeChild(touchToRemove);
              touches.splice(randomIndex, 1); // Remove from the touches array
            }, 500); // Wait a bit to allow fade-out before removing it
          }, 1000); // Remove one highlight every 1 second
        }

        // // Set an interval to remove the highlight one by one
        // if (touches.length === 2) {
        //   let counter = 0;
        //   const interval = setInterval(() => {
        //     if (counter < touches.length) {
        //       touches[counter].style.opacity = "0"; // Fade the highlight
        //       counter++;
        //     } else {
        //       clearInterval(interval); // Stop the interval once all highlights are off
        //       alert("Winner! All highlights removed.");
        //     }
        //   }, 1000); // Interval of 1 second for each highlight to disappear
        // }
      }

      // Track touch start event
      gameArea.addEventListener("touchstart", (e) => {
        e.preventDefault(); // Prevent default scrolling/zoom behavior

        // Only proceed if the number of touches is less than or equal to 7
        if (touches.length < 3) {
          const touch = e.changedTouches[0]; // Get the first touch (for simplicity, we use only one touch)
          highlightTouch(touch);
        }
      });

      // Track touch move event
      gameArea.addEventListener("touchmove", (e) => {
        // Prevent default scroll/zoom behavior
        e.preventDefault();
        // Optionally, track touch moves if necessary
      });

      // Track touch end event (remove the touch highlight)
      gameArea.addEventListener("touchend", (e) => {
        e.preventDefault();
        // For simplicity, we don't handle touch end explicitly here
      });
    </script>
  </body>
</html>
